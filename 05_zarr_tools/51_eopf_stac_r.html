<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Access the EOPF Zarr STAC API with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../05_zarr_tools/52_eopf_stac_qgis.html" rel="next">
<link href="../04_eopf_and_stac/44_eopf_stac_xarray_tutorial.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-0dd2bd5de344125cf763a379ddc3eb04.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<!-- Privacy-friendly analytics by Plausible -->
<script async="" src="https://plausible.io/js/pa-IdJjKOvKq9lif5cw4UK5i.js"></script>
<script>
  window.plausible=window.plausible||function(){(plausible.q=plausible.q||[]).push(arguments)},plausible.init=plausible.init||function(i){plausible.o=i||{}};
  plausible.init()
</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../05_zarr_tools/51_eopf_stac_r.html"><strong>Tools to work with EOPF Zarr</strong></a></li><li class="breadcrumb-item"><a href="../05_zarr_tools/51_eopf_stac_r.html"><span class="chapter-title">Access the EOPF Zarr STAC API with R</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../img/EOPF_FINAL_LOGO.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../img/EOPF_FINAL_LOGO.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/eopf-toolkit/eopf-101" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title"><strong>ESA EOPF 101</strong></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>About EOPF</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_about_eopf/11_about_eopf.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Introduction to the EOPF</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_about_eopf/12_about_cloudoptimized_formats.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">About cloud-optimised formats</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_about_eopf/13_overview_eopf_datasets.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Overview of EOPF Zarr Products</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>About EOPF Zarr</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_about_eopf_zarr/21_what_is_zarr.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Overview of the EOPF Zarr format</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_about_eopf_zarr/22_zarr_structure_S1GRD.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Discover EOPF Zarr - Sentinel-1 GRD</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_about_eopf_zarr/23_S1_basic_operations.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Operations with EOPF Zarr - Sentinel-1 GRD</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_about_eopf_zarr/24_zarr_struct_S2L2A.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Discover EOPF Zarr - Sentinel-2 L2A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_about_eopf_zarr/25_zarr_struct_S3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Discover EOPF Zarr - Sentinel-3 SLSTR Level-2 LST</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>About Chunking</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_about_chunking/31_zarr_chunking_intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">An introduction to Chunking</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_about_chunking/32_zarr_chunking_strat.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Best practices and Chunking optimisation in EOPF</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>EOPF and STAC</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_eopf_and_stac/41_stac_intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Introduction to STAC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_eopf_and_stac/42_eopf_stac_zarr_tutorial.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Explore the web interface of the EOPF Zarr STAC Catalog</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_eopf_and_stac/43_eopf_stac_connection.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Access the EOPF Zarr STAC API with Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_eopf_and_stac/44_eopf_stac_xarray_tutorial.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">From STAC to Data: Accessing EOPF Zarr with xarray</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Tools to work with EOPF Zarr</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_zarr_tools/51_eopf_stac_r.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Access the EOPF Zarr STAC API with R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_zarr_tools/52_eopf_stac_qgis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Access EOPF Zarr in QGIS Using STAC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_zarr_tools/53_eopf_zarr_r.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Access and analyse EOPF STAC Zarr data with R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_zarr_tools/57_rstac_gdalcubes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Creating a raster cube from STAC items of the EOPF Sentinel Zarr Samples Service using <code>rstac</code> and <code>gdalcubes</code></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>EOPF Zarr in Action</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_eopf_zarr_in_action/61_sardinia_s2_tfci.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Fire in Sardinia 2025 - Part 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_eopf_zarr_in_action/62_sardinia_s3_lst.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Fire in Sardinia 2025 - Part 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_eopf_zarr_in_action/63_sardinia_dNBR.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Fire in Sardinia 2025 - Part 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_eopf_zarr_in_action/64_flood_mapping_valencia.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Flood Mapping - Time Series Analysis in Valencia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_eopf_zarr_in_action/65_create_overviews.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Create and Visualise Multiscale Pyramids - Part 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_eopf_zarr_in_action/66_use_overviews.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Create and Visualise Multiscale Pyramids - Part 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_eopf_zarr_in_action/67_reservoir_surface_monitoring.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Reservoir Surface Monitoring</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_eopf_zarr_in_action/68_vegetation_anomalies.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Analyzing Forest Vegetation Anomalies Using Sentinel-2 Zarr Data Cubes</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../glossary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title"><strong>Glossary</strong></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link"><span class="chapter-title"><strong>References</strong></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#what-we-will-learn" id="toc-what-we-will-learn" class="nav-link" data-scroll-target="#what-we-will-learn">What we will learn</a></li>
  <li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites">Prerequisites</a></li>
  <li><a href="#connect-to-the-eopf-sample-service-stac-api" id="toc-connect-to-the-eopf-sample-service-stac-api" class="nav-link" data-scroll-target="#connect-to-the-eopf-sample-service-stac-api">Connect to the EOPF Sample Service STAC API</a></li>
  <li><a href="#browse-collections" id="toc-browse-collections" class="nav-link" data-scroll-target="#browse-collections">Browse collections</a></li>
  <li><a href="#browse-items" id="toc-browse-items" class="nav-link" data-scroll-target="#browse-items">Browse items</a>
  <ul class="collapse">
  <li><a href="#item-properties" id="toc-item-properties" class="nav-link" data-scroll-target="#item-properties">Item properties</a></li>
  <li><a href="#search-for-items" id="toc-search-for-items" class="nav-link" data-scroll-target="#search-for-items">Search for items</a></li>
  </ul></li>
  <li><a href="#browse-assets" id="toc-browse-assets" class="nav-link" data-scroll-target="#browse-assets">Browse assets</a></li>
  <li><a href="#now-it-is-your-turn" id="toc-now-it-is-your-turn" class="nav-link" data-scroll-target="#now-it-is-your-turn">üí™ Now it is your turn</a>
  <ul class="collapse">
  <li><a href="#task-1-explore-your-area-of-interest" id="toc-task-1-explore-your-area-of-interest" class="nav-link" data-scroll-target="#task-1-explore-your-area-of-interest">Task 1: Explore Your Area of Interest</a></li>
  <li><a href="#task-2-temporal-analysis" id="toc-task-2-temporal-analysis" class="nav-link" data-scroll-target="#task-2-temporal-analysis">Task 2: Temporal Analysis</a></li>
  <li><a href="#task-3-explore-the-sar-mission-and-combine-multiple-criteria" id="toc-task-3-explore-the-sar-mission-and-combine-multiple-criteria" class="nav-link" data-scroll-target="#task-3-explore-the-sar-mission-and-combine-multiple-criteria">Task 3: Explore the SAR Mission and combine multiple criteria</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#whats-next" id="toc-whats-next" class="nav-link" data-scroll-target="#whats-next">What‚Äôs next?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../05_zarr_tools/51_eopf_stac_r.html"><strong>Tools to work with EOPF Zarr</strong></a></li><li class="breadcrumb-item"><a href="../05_zarr_tools/51_eopf_stac_r.html"><span class="chapter-title">Access the EOPF Zarr STAC API with R</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Access the EOPF Zarr STAC API with R</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><a href="https://jupyterhub.user.eopf.eodc.eu/hub/login?next=%2Fhub%2Fspawn%3Fnext%3D%252Fhub%252Fuser-redirect%252Fgit-pull%253Frepo%253Dhttps%253A%252F%252Fgithub.com%252Feopf-toolkit%252Feopf-101%2526branch%253Dmain%2526urlpath%253Dlab%252Ftree%252Feopf-101%252F05_zarr_tools%252F51_eopf_stac_r.ipynb%23fancy-forms-config=%7B%22profile%22%3A%22choose-your-environment%22%2C%22image%22%3A%22unlisted_choice%22%2C%22image%3Aunlisted_choice%22%3A%224zm3809f.c1.de1.container-registry.ovh.net%2Feopf-toolkit-r%2Feopf-toolkit-r%3Alatest%22%2C%22autoStart%22%3A%22true%22%7D" target="_blank"> <button style="background-color:#0072ce; color:white; padding:0.6em 1.2em; font-size:1rem; border:none; border-radius:6px; margin-top:1em;"> üöÄ Launch this notebook in JupyterLab </button> </a></p>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>In this section, we will explore programmatic access of the EOPF Zarr Collections available in the <a href="https://stac.browser.user.eopf.eodc.eu/">EOPF Sentinel Zarr Sample Service STAC Catalog</a> using R. We will introduce R packages that enable us to effectively access and search through STAC catalogs.</p>
</section>
<section id="what-we-will-learn" class="level3">
<h3 class="anchored" data-anchor-id="what-we-will-learn">What we will learn</h3>
<ul>
<li>üîç How to <b>programmatically browse</b> through available collections available via the EOPF Zarr STAC Catalog, using the <code>rstac</code> package.</li>
<li>üìä Explore <b>collection metadata</b> in user-friendly terms</li>
<li>üéØ How to <b>search for specific data</b></li>
</ul>
</section>
<section id="prerequisites" class="level3">
<h3 class="anchored" data-anchor-id="prerequisites">Prerequisites</h3>
<p>An R environment is required to follow this tutorial, with R version &gt;= 4.4.0. For local development, we recommend using either <a href="https://posit.co/download/rstudio-desktop/">RStudio</a> or <a href="https://posit.co/products/ide/positron/">Positron</a> and making use of <a href="https://support.posit.co/hc/en-us/articles/200526207-Using-RStudio-Projects">RStudio projects</a> for a self-contained coding environment.</p>
<p>The <a href="https://brazil-data-cube.github.io/rstac/"><code>rstac</code> package</a> is required to follow this tutorial. You can install it directly from CRAN:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("rstac")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Then load the package into your environment:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstac)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="connect-to-the-eopf-sample-service-stac-api" class="level2">
<h2 class="anchored" data-anchor-id="connect-to-the-eopf-sample-service-stac-api">Connect to the EOPF Sample Service STAC API</h2>
<p>To access the EOPF Sample Service STAC catalog in R, we need to give the URL of the STAC API source (<a href="https://stac.core.eopf.eodc.eu/">https://stac.core.eopf.eodc.eu/</a>) using the function <code>stac()</code>.</p>
<p>The object <code>stac_source</code> is a query containing information used <em>to</em> connect to the API, but it does not actually make any requests. To make requests to the API, we will always need to use <code>get_request()</code> or <code>put_request()</code>, as appropriate. Running <code>get_request()</code> on <code>stac_source</code> actually retrieves the catalogue:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>stac_source <span class="ot">&lt;-</span> <span class="fu">stac</span>(<span class="st">"https://stac.core.eopf.eodc.eu/"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>stac_source <span class="sc">|&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_request</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Catalog
- id: eopf-sample-service-stac-api
- description: STAC catalog of the EOPF Sentinel Zarr Samples Service
- field(s): 
type, id, title, description, stac_version, conformsTo, links, stac_extensions</code></pre>
</div>
</div>
</section>
<section id="browse-collections" class="level2">
<h2 class="anchored" data-anchor-id="browse-collections">Browse collections</h2>
<p>A STAC <em>Collection</em> exists to relate similar data sets together through space, time, and shared metadata. Each Sentinel mission and the downstream analysis-ready data are examples of STAC Collections. To browse STAC Collections, the <code>collections()</code> function is used. We can see that there are 12 collections available in the API:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>stac_collections <span class="ot">&lt;-</span> stac_source <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collections</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_request</span>()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>stac_collections</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Collections
- collections (12 item(s)):
  - sentinel-2-l2a
  - sentinel-1-l1-grd
  - sentinel-3-slstr-l1-rbt
  - sentinel-3-olci-l2-lfr
  - sentinel-3-slstr-l2-lst
  - sentinel-3-slstr-l2-frp
  - sentinel-3-olci-l2-lrr
  - sentinel-3-olci-l1-efr
  - sentinel-2-l1c
  - sentinel-1-l1-slc
  - sentinel-3-olci-l1-err
  - sentinel-1-l2-ocn
- field(s): collections, links, numberMatched, numberReturned</code></pre>
</div>
</div>
<p>The default printing of the <code>stac_collections()</code> object summarises what‚Äôs been returned, but does not give all of the information. To see more about what‚Äôs been returned, we use <code>str()</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>stac_collections <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>(<span class="at">max.level =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ collections   :List of 12
 $ links         :List of 3
  ..- attr(*, "class")= chr [1:2] "doc_links" "list"
 $ numberMatched : int 12
 $ numberReturned: int 12
 - attr(*, "class")= chr [1:3] "doc_collections" "rstac_doc" "list"</code></pre>
</div>
</div>
<p>Here, we can see that there is an entry <code>"collections"</code> within <code>stac_collections</code>, which we access to return the collections themselves (using <code>head()</code> to only return a few). This shows additional details about each collection, such as the collection id, title, description, and additional fields in the collections.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>stac_collections[[<span class="st">"collections"</span>]] <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
###Collection
- id: sentinel-2-l2a
- title: Sentinel-2 Level-2A
- description: 
The Sentinel-2 Level-2A Collection 1 product provides orthorectified Surface Reflectance (Bottom-Of-Atmosphere: BOA), with sub-pixel multispectral and multitemporal registration accuracy. Scene Classification (including Clouds and Cloud Shadows), AOT (Aerosol Optical Thickness) and WV (Water Vapour) maps are included in the product.
- field(s): 
id, type, links, title, assets, extent, license, keywords, providers, summaries, description, item_assets, stac_version, stac_extensions

[[2]]
###Collection
- id: sentinel-1-l1-grd
- title: Sentinel-1 Level-1 GRD
- description: 
The Sentinel-1 Level-1 Ground Range Detected (GRD) products consist of focused SAR data that has been detected, multi-looked and projected to ground range using the Earth ellipsoid model WGS84. The ellipsoid projection of the GRD products is corrected using the terrain height specified in the product general annotation. The terrain height used varies in azimuth and it is constant in range (For IW/EW modes only the terrain height of first subswath is considered)
- field(s): 
id, type, links, title, assets, extent, license, keywords, providers, summaries, description, item_assets, stac_version, stac_extensions

[[3]]
###Collection
- id: sentinel-3-slstr-l1-rbt
- title: Sentinel-3 SLSTR Level-1 RBT
- description: 
The Sentinel-3 SLSTR Level-1B RBT product provides radiances and brightness temperatures for each pixel in a regular image grid for each view and SLSTR channel. In addition, it also contains annotations data associated with each image pixels.
- field(s): 
id, type, links, title, assets, extent, license, keywords, providers, summaries, description, item_assets, stac_version, stac_extensions</code></pre>
</div>
</div>
<p>The Sentinel-2 Level-2A collection can be accessed by getting the first entry in <code>stac_collections()[["collections"]]</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>stac_collections[[<span class="st">"collections"</span>]][[<span class="dv">1</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Collection
- id: sentinel-2-l2a
- title: Sentinel-2 Level-2A
- description: 
The Sentinel-2 Level-2A Collection 1 product provides orthorectified Surface Reflectance (Bottom-Of-Atmosphere: BOA), with sub-pixel multispectral and multitemporal registration accuracy. Scene Classification (including Clouds and Cloud Shadows), AOT (Aerosol Optical Thickness) and WV (Water Vapour) maps are included in the product.
- field(s): 
id, type, links, title, assets, extent, license, keywords, providers, summaries, description, item_assets, stac_version, stac_extensions</code></pre>
</div>
</div>
<p>However, the best way to access a specific collection is to search for it directly using the collection ID. The ID, ‚Äúsentinel-2-l2a‚Äù, is visible in the Collection output above. It is also accessible in the browsable STAC catalog of the EOPF Sentinel Zarr Samples Service, on the <a href="https://stac.browser.user.eopf.eodc.eu/collections/sentinel-2-l2a">page for that collection</a>, under ‚ÄúSource.‚Äù</p>
<p><img src="./img/51_eopf-stac-access-collections-id.png" class="img-fluid"></p>
<p>The collection ID can be supplied directly in the <code>collections()</code> function. If we look at the query without getting the result, we can see that it has been formed using the <code>collection_id</code>, ‚Äúsentinel-2-l2a‚Äù, as a filter parameter.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sentinel_2_l2a_query <span class="ot">&lt;-</span> stac_source <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collections</span>(<span class="at">collection_id =</span> <span class="st">"sentinel-2-l2a"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>sentinel_2_l2a_query</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###rstac_query
- url: https://stac.core.eopf.eodc.eu/
- params:
  - collection_id: sentinel-2-l2a
- field(s): version, base_url, endpoint, params, verb, encode</code></pre>
</div>
</div>
<p>And that running <code>get_request()</code> will return the collection itself:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sentinel_2_l2a_query <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_request</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Collection
- id: sentinel-2-l2a
- title: Sentinel-2 Level-2A
- description: 
The Sentinel-2 Level-2A Collection 1 product provides orthorectified Surface Reflectance (Bottom-Of-Atmosphere: BOA), with sub-pixel multispectral and multitemporal registration accuracy. Scene Classification (including Clouds and Cloud Shadows), AOT (Aerosol Optical Thickness) and WV (Water Vapour) maps are included in the product.
- field(s): 
id, type, links, title, assets, extent, license, keywords, providers, summaries, description, item_assets, stac_version, stac_extensions</code></pre>
</div>
</div>
</section>
<section id="browse-items" class="level2">
<h2 class="anchored" data-anchor-id="browse-items">Browse items</h2>
<p>Within collections, there are <em>items</em>. Items are the building blocks for STAC. At their core, they are GeoJSON data, along with additional metadata which ensures data provenance is maintained and specific data attributes are captured. A single capture from a Sentinel mission is an example of a STAC item. To get an overview of items within a collection, the <code>items()</code> function is used.</p>
<p>An important thing to note with <code>rstac</code> is that you cannot continue to build queries on top of ones that have already had their results returned (via <code>get_request()</code>). It may make sense for a typical workflow in R to ‚Äúget‚Äù the collection, then to try to get the items from it, but this will produce an error:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sentinel_2_l2a_collection &lt;- stac_source |&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   collections(collection_id = "sentinel-2-l2a") |&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   get_request()</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sentinel_2_l2a_collection |&gt;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   items()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<pre><code>Error: Invalid rstac_query value.</code></pre>
<p>If you see this error ‚Äî <code>"Invalid rstac_query value"</code> ‚Äî ensure that you are running <code>get_request()</code> at the very end of your query building functions. Using <code>items()</code> this way, we can see that it returns a summary of the collection‚Äôs items:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sentinel_2_l2a_collection_items <span class="ot">&lt;-</span> stac_source <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collections</span>(<span class="at">collection_id =</span> <span class="st">"sentinel-2-l2a"</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">items</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_request</span>()</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>sentinel_2_l2a_collection_items</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Items
- features (10 item(s)):
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UFB_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UFA_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UEC_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UEB_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UEA_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UDC_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UDB_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UDA_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UCB_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UCA_20260212T104509
- assets: 
AOT_10m, B01_20m, B02_10m, B03_10m, B04_10m, B05_20m, B06_20m, B07_20m, B08_10m, B09_60m, B11_20m, B12_20m, B8A_20m, product, product_metadata, SCL_20m, SR_10m, SR_20m, SR_60m, TCI_10m, WVP_10m, zipped_product
- item's fields: 
assets, bbox, collection, geometry, id, links, properties, stac_extensions, stac_version, type</code></pre>
</div>
</div>
<p>The first 10 items are returned. This number can be changed via the <code>limit</code> argument in <code>items()</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>stac_source <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collections</span>(<span class="at">collection_id =</span> <span class="st">"sentinel-2-l2a"</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">items</span>(<span class="at">limit =</span> <span class="dv">20</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_request</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Items
- features (20 item(s)):
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UFB_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UFA_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UEC_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UEB_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UEA_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UDC_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UDB_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UDA_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UCB_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UCA_20260212T104509
  - ... with 10 more feature(s).
- assets: 
AOT_10m, B01_20m, B02_10m, B03_10m, B04_10m, B05_20m, B06_20m, B07_20m, B08_10m, B09_60m, B11_20m, B12_20m, B8A_20m, product, product_metadata, SCL_20m, SR_10m, SR_20m, SR_60m, TCI_10m, WVP_10m, zipped_product
- item's fields: 
assets, bbox, collection, geometry, id, links, properties, stac_extensions, stac_version, type</code></pre>
</div>
</div>
<section id="item-properties" class="level3">
<h3 class="anchored" data-anchor-id="item-properties">Item properties</h3>
<p>We can look closer at individual items to see the metadata attached to them. Items are stored under <code>"features"</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sentinel_2_l2a_collection_items[[<span class="st">"features"</span>]] <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
###Item
- id: S2A_MSIL2A_20260212T094641_N0512_R036_T34UFB_20260212T104509
- collection: sentinel-2-l2a
- bbox: xmin: 22.40872, ymin: 50.43472, xmax: 23.75129, ymax: 51.21636
- datetime: 2026-02-12T09:46:41.024000Z
- assets: 
SR_10m, SR_20m, SR_60m, AOT_10m, B01_20m, B02_10m, B03_10m, B04_10m, B05_20m, B06_20m, B07_20m, B08_10m, B09_60m, B11_20m, B12_20m, B8A_20m, SCL_20m, TCI_10m, WVP_10m, product, zipped_product, product_metadata
- item's fields: 
assets, bbox, collection, geometry, id, links, properties, stac_extensions, stac_version, type

[[2]]
###Item
- id: S2A_MSIL2A_20260212T094641_N0512_R036_T34UFA_20260212T104509
- collection: sentinel-2-l2a
- bbox: xmin: 22.39259, ymin: 49.72290, xmax: 23.54807, ymax: 50.54374
- datetime: 2026-02-12T09:46:41.024000Z
- assets: 
SR_10m, SR_20m, SR_60m, AOT_10m, B01_20m, B02_10m, B03_10m, B04_10m, B05_20m, B06_20m, B07_20m, B08_10m, B09_60m, B11_20m, B12_20m, B8A_20m, SCL_20m, TCI_10m, WVP_10m, product, zipped_product, product_metadata
- item's fields: 
assets, bbox, collection, geometry, id, links, properties, stac_extensions, stac_version, type</code></pre>
</div>
</div>
<p>And an individual item contains a lot of information, such as its bounding box:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>sentinel_2_l2a_first_item <span class="ot">&lt;-</span> sentinel_2_l2a_collection_items[[<span class="st">"features"</span>]][[<span class="dv">1</span>]]</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>sentinel_2_l2a_first_item[[<span class="st">"bbox"</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22.40872 50.43472 23.75129 51.21636</code></pre>
</div>
</div>
<p>And many more additional properties, with their properties under <code>"properties"</code> in an individual item.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sentinel_2_l2a_first_item[[<span class="st">"properties"</span>]] <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "gsd"                                  
 [2] "created"                              
 [3] "mission"                              
 [4] "sci:doi"                              
 [5] "updated"                              
 [6] "datetime"                             
 [7] "platform"                             
 [8] "grid:code"                            
 [9] "proj:bbox"                            
[10] "proj:code"                            
[11] "providers"                            
[12] "published"                            
[13] "deprecated"                           
[14] "instruments"                          
[15] "end_datetime"                         
[16] "product:type"                         
[17] "constellation"                        
[18] "eo:snow_cover"                        
[19] "mgrs:utm_zone"                        
[20] "proj:centroid"                        
[21] "eo:cloud_cover"                       
[22] "start_datetime"                       
[23] "sat:orbit_state"                      
[24] "eopf:datatake_id"                     
[25] "mgrs:grid_square"                     
[26] "processing:level"                     
[27] "view:sun_azimuth"                     
[28] "eopf:datastrip_id"                    
[29] "mgrs:latitude_band"                   
[30] "processing:lineage"                   
[31] "processing:version"                   
[32] "product:timeliness"                   
[33] "sat:absolute_orbit"                   
[34] "sat:relative_orbit"                   
[35] "view:sun_elevation"                   
[36] "processing:facility"                  
[37] "processing:software"                  
[38] "eopf:instrument_mode"                 
[39] "product:timeliness_category"          
[40] "sat:platform_international_designator"</code></pre>
</div>
</div>
<p>For example, the EOPF instrument mode:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sentinel_2_l2a_first_item[[<span class="st">"properties"</span>]][[<span class="st">"eopf:instrument_mode"</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "INS-NOBS"</code></pre>
</div>
</div>
<p>For the rest of the tutorial, we will use a small helper function that accesses a given property for the <em>first</em> item returned in a search.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>get_first_item_property <span class="ot">&lt;-</span> <span class="cf">function</span>(search_results, property) {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  search_results[[<span class="st">"features"</span>]][[<span class="dv">1</span>]][[<span class="st">"properties"</span>]][[property]]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>sentinel_2_l2a_collection_items <span class="sc">|&gt;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_first_item_property</span>(<span class="st">"eopf:instrument_mode"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "INS-NOBS"</code></pre>
</div>
</div>
</section>
<section id="search-for-items" class="level3">
<h3 class="anchored" data-anchor-id="search-for-items">Search for items</h3>
<p>If the goal is to access data from a specific mission, it is best to <em>search</em> within a collection‚Äôs items, using some of the properties explored above. It‚Äôs possible to search based on a number of criteria, including a bounding box, time frame, and other mission properties.</p>
<section id="search-by-a-bounding-box" class="level4">
<h4 class="anchored" data-anchor-id="search-by-a-bounding-box">Search by a bounding box</h4>
<p>To narrow down items based on a bounding box or time frame, the <code>stac_search()</code> function is used. The collection ID is provided in the <code>collections()</code> argument, and bounding box and time frame are <code>bbox</code> and <code>datetime</code>, respectively.</p>
<p>The bounding box values take the sequence of: minimum longitude, minimum latitude, maximum longitude, and maximum latitude, and their coordinate reference system is WGS84. For items whose bounding boxes intersect with Vienna:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>stac_source <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stac_search</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">collections =</span> <span class="st">"sentinel-2-l2a"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">bbox =</span> <span class="fu">c</span>(<span class="fl">16.1736</span>, <span class="fl">48.1157</span>, <span class="fl">16.5897</span>, <span class="fl">48.3254</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_request</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Items
- features (10 item(s)):
  - S2C_MSIL2A_20260210T095141_N0512_R079_T33UXP_20260210T132914
  - S2C_MSIL2A_20260210T095141_N0512_R079_T33UWP_20260210T132914
  - S2B_MSIL2A_20260208T100049_N0512_R122_T33UXP_20260208T134756
  - S2B_MSIL2A_20260208T100049_N0512_R122_T33UWP_20260208T134756
  - S2B_MSIL2A_20260205T095109_N0512_R079_T33UXP_20260205T152522
  - S2B_MSIL2A_20260205T095109_N0512_R079_T33UWP_20260205T152522
  - S2C_MSIL2A_20260203T100221_N0511_R122_T33UXP_20260203T132812
  - S2C_MSIL2A_20260203T100221_N0511_R122_T33UWP_20260203T132812
  - S2C_MSIL2A_20260131T095231_N0511_R079_T33UXP_20260131T135211
  - S2C_MSIL2A_20260131T095231_N0511_R079_T33UWP_20260131T135211
- assets: 
AOT_10m, B01_20m, B02_10m, B03_10m, B04_10m, B05_20m, B06_20m, B07_20m, B08_10m, B09_60m, B11_20m, B12_20m, B8A_20m, product, product_metadata, SCL_20m, SR_10m, SR_20m, SR_60m, TCI_10m, WVP_10m, zipped_product
- item's fields: 
assets, bbox, collection, geometry, id, links, properties, stac_extensions, stac_version, type</code></pre>
</div>
</div>
<p>This does ‚Äì again by default ‚Äì return the first 10 items, but the number returned can be increased via the <code>limit</code> argument in <code>stac_search()</code>.</p>
</section>
<section id="search-by-a-time-frame" class="level4">
<h4 class="anchored" data-anchor-id="search-by-a-time-frame">Search by a time frame</h4>
<p>When searching for a specific time frame, items that have a datetime property that <em>intersects</em> with the given time frame will be returned. It‚Äôs therefore best to search for a closed or open interval, rather than a specific date and time (which might be difficult to match exactly to an item‚Äôs time!). The date-time must be given in RFC 3339 format.</p>
<p>To search for a closed interval, separate two date-times by a ‚Äú/‚Äù, e.g.&nbsp;<code>"2024-12-01T01:00:00Z/2024-12-01T05:00:00Z"</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>matching_timeframe_items <span class="ot">&lt;-</span> stac_source <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stac_search</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">collections =</span> <span class="st">"sentinel-2-l2a"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">datetime =</span> <span class="st">"2024-12-01T01:00:00Z/2024-12-01T05:00:00Z"</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_request</span>()</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>matching_timeframe_items</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Items
- features (10 item(s)):
  - S2A_MSIL2A_20241201T045911_N0511_R133_T44HKD_20241201T065447
  - S2A_MSIL2A_20241201T045911_N0511_R133_T44HKC_20241201T065447
  - S2A_MSIL2A_20241201T045911_N0511_R133_T43HGU_20241201T065447
  - S2A_MSIL2A_20241201T045911_N0511_R133_T43HGT_20241201T065447
  - S2A_MSIL2A_20241201T045911_N0511_R133_T43HGS_20241201T065447
  - S2A_MSIL2A_20241201T045911_N0511_R133_T43HFU_20241201T065447
  - S2A_MSIL2A_20241201T045911_N0511_R133_T43HFT_20241201T065447
  - S2A_MSIL2A_20241201T045911_N0511_R133_T43HFS_20241201T065447
  - S2A_MSIL2A_20241201T045911_N0511_R133_T43HEV_20241201T065447
  - S2A_MSIL2A_20241201T045911_N0511_R133_T43HEU_20241201T065447
- assets: 
AOT_10m, B01_20m, B02_10m, B03_10m, B04_10m, B05_20m, B06_20m, B07_20m, B08_10m, B09_60m, B11_20m, B12_20m, B8A_20m, product, product_metadata, SCL_20m, SR_10m, SR_20m, SR_60m, TCI_10m, WVP_10m
- item's fields: 
assets, bbox, collection, geometry, id, links, properties, stac_extensions, stac_version, type</code></pre>
</div>
</div>
<p>We can access the matching item‚Äôs <code>datetime</code> property to see that it falls within the specified interval:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>matching_timeframe_items <span class="sc">|&gt;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_first_item_property</span>(<span class="st">"datetime"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-12-01T04:59:11.024000Z"</code></pre>
</div>
</div>
<p>To search by an open interval, ‚Äú..‚Äù is used to indicate the open end, e.g.&nbsp;<code>"../2024-01-01T23:00:00Z"</code> representing prior to that date-time, and <code>"2024-01-01T23:00:00Z/.."</code> representing after it:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>stac_source <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stac_search</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">collections =</span> <span class="st">"sentinel-2-l2a"</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">datetime =</span> <span class="st">"2025-01-01T23:00:00Z/.."</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_request</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Items
- features (10 item(s)):
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UFB_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UFA_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UEC_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UEB_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UEA_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UDC_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UDB_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UDA_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UCB_20260212T104509
  - S2A_MSIL2A_20260212T094641_N0512_R036_T34UCA_20260212T104509
- assets: 
AOT_10m, B01_20m, B02_10m, B03_10m, B04_10m, B05_20m, B06_20m, B07_20m, B08_10m, B09_60m, B11_20m, B12_20m, B8A_20m, product, product_metadata, SCL_20m, SR_10m, SR_20m, SR_60m, TCI_10m, WVP_10m, zipped_product
- item's fields: 
assets, bbox, collection, geometry, id, links, properties, stac_extensions, stac_version, type</code></pre>
</div>
</div>
</section>
<section id="search-by-other-item-properties" class="level4">
<h4 class="anchored" data-anchor-id="search-by-other-item-properties">Search by other item properties</h4>
<p>As shown above, there are a number of other properties attached to STAC items. We can also search using these properties. The <code>stac_search()</code> function is limited to properties like bounding box and time frame, so instead we use <code>ext_filter()</code>. This is a function that makes use of the Common Query Language (CQL2) filter extension, and allows us to do more complicated searching and querying using SQL-like language. It is also important to note that when using <code>ext_filter()</code>, we switch to using <code>post_request()</code> instead of <code>get_request()</code>.</p>
<p>For this searching, it is helpful to know the <em>data type</em> for an item property in advance, as this will impact what operation to use within <code>ext_filter()</code>. We create an additional helper function for this:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>get_item_property_type <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">property =</span> <span class="cn">NULL</span>) {</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  api_res <span class="ot">&lt;-</span> rstac<span class="sc">:::</span><span class="fu">make_get_request</span>(<span class="st">"https://stac.core.eopf.eodc.eu/api"</span>) <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    rstac<span class="sc">:::</span><span class="fu">content_response_json</span>()</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  item_properties_schema <span class="ot">&lt;-</span> api_res[[<span class="st">"components"</span>]][[<span class="st">"schemas"</span>]][[<span class="st">"ItemProperties"</span>]][[<span class="st">"properties"</span>]]</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  property_types <span class="ot">&lt;-</span> <span class="fu">lapply</span>(item_properties_schema, <span class="cf">function</span>(x) {</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    x[[<span class="st">"anyOf"</span>]][[<span class="dv">1</span>]][[<span class="st">"type"</span>]]</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(property)) {</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    property_types</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    property_types[[property]]</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>When no argument is passed to this function, it will return all of the properties and their types:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_item_property_type</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$title
[1] "string"

$description
[1] "string"

$datetime
[1] "string"

$created
[1] "string"

$updated
[1] "string"

$start_datetime
[1] "string"

$end_datetime
[1] "string"

$license
[1] "string"

$providers
[1] "array"

$platform
[1] "string"

$instruments
[1] "array"

$constellation
[1] "string"

$mission
[1] "string"

$gsd
[1] "number"</code></pre>
</div>
</div>
<p>When the name of a property is passed, it will return the type of that property. We can see, for example, that <code>platform</code> is a string, while <code>instruments</code> is an array.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_item_property_type</span>(<span class="st">"platform"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "string"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_item_property_type</span>(<span class="st">"instruments"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "array"</code></pre>
</div>
</div>
<p>Since <code>platform</code> is a string, we use <code>==</code> to indicate equality. For example, to search for items whose platform is ‚Äúsentinel-2b‚Äù:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>sentinel_2b_platform_results <span class="ot">&lt;-</span> stac_source <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stac_search</span>(<span class="at">collections =</span> <span class="st">"sentinel-2-l2a"</span>) <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ext_filter</span>(platform <span class="sc">==</span> <span class="st">"sentinel-2b"</span>) <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">post_request</span>()</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>sentinel_2b_platform_results</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Items
- features (10 item(s)):
  - S2B_MSIL2A_20260212T094029_N0512_R036_T37WEU_20260212T115326
  - S2B_MSIL2A_20260212T094029_N0512_R036_T37WET_20260212T115326
  - S2B_MSIL2A_20260212T094029_N0512_R036_T37WES_20260212T115326
  - S2B_MSIL2A_20260212T094029_N0512_R036_T37WDU_20260212T115326
  - S2B_MSIL2A_20260212T094029_N0512_R036_T37WDT_20260212T115326
  - S2B_MSIL2A_20260212T094029_N0512_R036_T37WDS_20260212T115326
  - S2B_MSIL2A_20260212T094029_N0512_R036_T37WDR_20260212T115326
  - S2B_MSIL2A_20260212T094029_N0512_R036_T37WDQ_20260212T115326
  - S2B_MSIL2A_20260212T094029_N0512_R036_T37WCV_20260212T115326
  - S2B_MSIL2A_20260212T094029_N0512_R036_T36WXV_20260212T115326
- assets: 
AOT_10m, B01_20m, B02_10m, B03_10m, B04_10m, B05_20m, B06_20m, B07_20m, B08_10m, B09_60m, B11_20m, B12_20m, B8A_20m, product, product_metadata, SCL_20m, SR_10m, SR_20m, SR_60m, TCI_10m, WVP_10m, zipped_product
- item's fields: 
assets, bbox, collection, geometry, id, links, properties, stac_extensions, stac_version, type</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>sentinel_2b_platform_results <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_first_item_property</span>(<span class="st">"platform"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sentinel-2b"</code></pre>
</div>
</div>
<p>If the search value is contained in another variable, the variable must be escaped in the search by using double curly braces:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>search_platform <span class="ot">&lt;-</span> <span class="st">"sentinel-2b"</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>sentinel_2b_platform_results <span class="ot">&lt;-</span> stac_source <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stac_search</span>(<span class="at">collections =</span> <span class="st">"sentinel-2-l2a"</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ext_filter</span>(platform <span class="sc">==</span> {{ search_platform }}) <span class="sc">|&gt;</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">post_request</span>()</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>sentinel_2b_platform_results <span class="sc">|&gt;</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_first_item_property</span>(<span class="st">"platform"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sentinel-2b"</code></pre>
</div>
</div>
<p>Note also that there is no <code>limit</code> argument in <code>ext_filter()</code>. To limit the number of items returned, the limit is supplied in <code>stac_search()</code> beforehand, since these search functions build upon one another:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>stac_source <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stac_search</span>(<span class="at">collections =</span> <span class="st">"sentinel-2-l2a"</span>, <span class="at">limit =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ext_filter</span>(platform <span class="sc">==</span> {{ search_platform }}) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">post_request</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Items
- features (1 item(s)):
  - S2B_MSIL2A_20260212T094029_N0512_R036_T37WEU_20260212T115326
- assets: 
AOT_10m, B01_20m, B02_10m, B03_10m, B04_10m, B05_20m, B06_20m, B07_20m, B08_10m, B09_60m, B11_20m, B12_20m, B8A_20m, product, product_metadata, SCL_20m, SR_10m, SR_20m, SR_60m, TCI_10m, WVP_10m, zipped_product
- item's fields: 
assets, bbox, collection, geometry, id, links, properties, stac_extensions, stac_version, type</code></pre>
</div>
</div>
<p>To search for items with cloud cover of less than 40, we use <code>&lt;=</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>stac_source <span class="sc">|&gt;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stac_search</span>(<span class="at">collections =</span> <span class="st">"sentinel-2-l2a"</span>) <span class="sc">|&gt;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ext_filter</span>(<span class="st">`</span><span class="at">eo:cloud_cover</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">40</span>) <span class="sc">|&gt;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">post_request</span>() <span class="sc">|&gt;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_first_item_property</span>(<span class="st">"eo:cloud_cover"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36.98742</code></pre>
</div>
</div>
<p>If we want to search for items where <code>instruments</code> is ‚Äúmsi‚Äù, we use the <code>a_contains()</code> function. We need to use this instead of <code>==</code> because <code>instruments</code> is an <code>array</code>, as seen above. This means it operates like a list within R, and can contain multiple values ‚Äì <code>a_contains()</code> searches for the value <code>"msi"</code> within the list of values that is <code>instruments</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>stac_source <span class="sc">|&gt;</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stac_search</span>(<span class="at">collections =</span> <span class="st">"sentinel-2-l2a"</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ext_filter</span>(<span class="fu">a_contains</span>(instruments, <span class="st">"msi"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">post_request</span>() <span class="sc">|&gt;</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_first_item_property</span>(<span class="st">"instruments"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "msi"</code></pre>
</div>
</div>
<p>Note that there is currently a bug with how the <code>rstac</code> package converts the API‚Äôs data to an R object. This bug makes it unclear that <code>instruments</code> is a <em>list</em> that needs to be searched within (instead of a single value). There is an <a href="https://github.com/brazil-data-cube/rstac/issues/175">issue to fix this bug in the <code>rstac</code> github repository</a>. We hope that the helper function <code>get_item_property_type()</code> will be helpful in the meantime to determine which filtering operation to use.</p>
<p>The <a href="https://brazil-data-cube.github.io/rstac/reference/ext_filter.html#details">documentation for <code>ext_filter()</code></a> contains information on how to construct many more searches than we‚Äôve shown here.</p>
</section>
<section id="combine-search-criteria" class="level4">
<h4 class="anchored" data-anchor-id="combine-search-criteria">Combine search criteria</h4>
<p>You can combine multiple filter criteria by specifying them together. We have already seen how to combine multiple criteria (collection ID and bounding box, for example) in <code>stac_search()</code> by using the named arguments. We can also filter by bounding box and datetime in the same way. Multiple criteria in <code>ext_filter()</code> are separated by <code>&amp;&amp;</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>multiple_criteria_items <span class="ot">&lt;-</span> stac_source <span class="sc">|&gt;</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stac_search</span>(</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">collections =</span> <span class="st">"sentinel-2-l2a"</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">bbox =</span> <span class="fu">c</span>(<span class="fl">16.1736</span>, <span class="fl">48.1157</span>, <span class="fl">16.5897</span>, <span class="fl">48.3254</span>),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">datetime =</span> <span class="st">"../2025-06-01T23:00:00Z"</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ext_filter</span>(</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    platform <span class="sc">==</span> <span class="st">"sentinel-2a"</span> <span class="sc">&amp;&amp;</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">eo:cloud_cover</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">40</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">post_request</span>()</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>multiple_criteria_items <span class="sc">|&gt;</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_first_item_property</span>(<span class="st">"datetime"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-05-31T10:00:51.024000Z"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>multiple_criteria_items <span class="sc">|&gt;</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_first_item_property</span>(<span class="st">"platform"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sentinel-2a"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>multiple_criteria_items <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_first_item_property</span>(<span class="st">"eo:cloud_cover"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.41613</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="browse-assets" class="level2">
<h2 class="anchored" data-anchor-id="browse-assets">Browse assets</h2>
<p>Finally, assets fall under STAC items and direct users to the actual data itself. Each asset refers to data associated with the Item that can be downloaded or streamed.</p>
<p>We will look at the assets for a specific item from the Sentinel-2 Level-2A collection. Like collections, items can be filtered by their IDs. Their IDs are also available through the API:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>sentinel_2_l2a_collection_items[[<span class="st">"features"</span>]][[<span class="dv">1</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Item
- id: S2A_MSIL2A_20260212T094641_N0512_R036_T34UFB_20260212T104509
- collection: sentinel-2-l2a
- bbox: xmin: 22.40872, ymin: 50.43472, xmax: 23.75129, ymax: 51.21636
- datetime: 2026-02-12T09:46:41.024000Z
- assets: 
SR_10m, SR_20m, SR_60m, AOT_10m, B01_20m, B02_10m, B03_10m, B04_10m, B05_20m, B06_20m, B07_20m, B08_10m, B09_60m, B11_20m, B12_20m, B8A_20m, SCL_20m, TCI_10m, WVP_10m, product, zipped_product, product_metadata
- item's fields: 
assets, bbox, collection, geometry, id, links, properties, stac_extensions, stac_version, type</code></pre>
</div>
</div>
<p>Or through the STAC catalog of the EOPF Sentinel Zarr Samples Service, on the page for that item, under ‚ÄúSource‚Äù:</p>
<p><img src="./img/51_eopf-stac-access-items-id.png" class="img-fluid"></p>
<p>To select a single item, supply its ID in the <code>items()</code> function:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>example_item <span class="ot">&lt;-</span> stac_source <span class="sc">|&gt;</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collections</span>(<span class="st">"sentinel-2-l2a"</span>) <span class="sc">|&gt;</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">items</span>(sentinel_2_l2a_collection_items[[<span class="st">"features"</span>]][[<span class="dv">1</span>]][[<span class="st">"id"</span>]]) <span class="sc">|&gt;</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_request</span>()</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>example_item</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Item
- id: S2A_MSIL2A_20260212T094641_N0512_R036_T34UFB_20260212T104509
- collection: sentinel-2-l2a
- bbox: xmin: 22.40872, ymin: 50.43472, xmax: 23.75129, ymax: 51.21636
- datetime: 2026-02-12T09:46:41.024000Z
- assets: 
SR_10m, SR_20m, SR_60m, AOT_10m, B01_20m, B02_10m, B03_10m, B04_10m, B05_20m, B06_20m, B07_20m, B08_10m, B09_60m, B11_20m, B12_20m, B8A_20m, SCL_20m, TCI_10m, WVP_10m, product, zipped_product, product_metadata
- item's fields: 
assets, bbox, collection, geometry, id, links, properties, stac_extensions, stac_version, type</code></pre>
</div>
</div>
<p>There are a number of helpful functions for working with an item‚Äôs assets, such as <code>items_assets()</code> which lists them:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List the assets in an item</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>example_item <span class="sc">|&gt;</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">items_assets</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "SR_10m"           "SR_20m"           "SR_60m"           "AOT_10m"         
 [5] "B01_20m"          "B02_10m"          "B03_10m"          "B04_10m"         
 [9] "B05_20m"          "B06_20m"          "B07_20m"          "B08_10m"         
[13] "B09_60m"          "B11_20m"          "B12_20m"          "B8A_20m"         
[17] "SCL_20m"          "TCI_10m"          "WVP_10m"          "product"         
[21] "zipped_product"   "product_metadata"</code></pre>
</div>
</div>
<p>And <code>assets_select()</code> which allows us to select specific assets (in this case, the ‚ÄúSurface Reflectance - 10m‚Äù asset):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>sr_10m <span class="ot">&lt;-</span> example_item <span class="sc">|&gt;</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assets_select</span>(<span class="at">asset_names =</span> <span class="st">"SR_10m"</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>sr_10m</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Item
- id: S2A_MSIL2A_20260212T094641_N0512_R036_T34UFB_20260212T104509
- collection: sentinel-2-l2a
- bbox: xmin: 22.40872, ymin: 50.43472, xmax: 23.75129, ymax: 51.21636
- datetime: 2026-02-12T09:46:41.024000Z
- assets: SR_10m
- item's fields: 
assets, bbox, collection, geometry, id, links, properties, stac_extensions, stac_version, type</code></pre>
</div>
</div>
<p>For example, the ‚Äúproduct‚Äù asset will be useful to working with EOPF Sample Service Zarr data, as this is the top-level Zarr hierarchy. We can select this asset, and then use <code>assets_url()</code> to get its URL:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>example_item <span class="sc">|&gt;</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assets_select</span>(<span class="at">asset_names =</span> <span class="st">"product"</span>) <span class="sc">|&gt;</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assets_url</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "https://objects.eodc.eu:443/e05ab01a9d56408d82ac32d69a5aae2a:202602-s02msil2a-eu/12/products/cpm_v262/S2A_MSIL2A_20260212T094641_N0512_R036_T34UFB_20260212T104509.zarr"</code></pre>
</div>
</div>
<p>It is also helpful to know which assets actually contain Zarr data. Assets can be <em>Zarr groups</em>, which share common dimensions and coordinates, and contain Zarr arrays within them. An asset can also be an individual Zarr array.</p>
<p>To look more at this, we will extract metadata attached to the Zarr assets. The <code>"assets"</code> entry of <code>example_item</code> contains a lot of useful information, but it is a bit difficult to read and manipulate:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(example_item[[<span class="st">"assets"</span>]])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "SR_10m"           "SR_20m"           "SR_60m"           "AOT_10m"         
 [5] "B01_20m"          "B02_10m"          "B03_10m"          "B04_10m"         
 [9] "B05_20m"          "B06_20m"          "B07_20m"          "B08_10m"         
[13] "B09_60m"          "B11_20m"          "B12_20m"          "B8A_20m"         
[17] "SCL_20m"          "TCI_10m"          "WVP_10m"          "product"         
[21] "zipped_product"   "product_metadata"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>example_item[[<span class="st">"assets"</span>]][[<span class="st">"SR_10m"</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$gsd
[1] 10

$href
[1] "https://objects.eodc.eu:443/e05ab01a9d56408d82ac32d69a5aae2a:202602-s02msil2a-eu/12/products/cpm_v262/S2A_MSIL2A_20260212T094641_N0512_R036_T34UFB_20260212T104509.zarr/measurements/reflectance/r10m"

$type
[1] "application/vnd+zarr"

$bands
$bands[[1]]
$bands[[1]]$name
[1] "B02"

$bands[[1]]$description
[1] "Blue (band 2)"

$bands[[1]]$`eo:common_name`
[1] "blue"

$bands[[1]]$`eo:center_wavelength`
[1] 0.49

$bands[[1]]$`eo:full_width_half_max`
[1] 0.098


$bands[[2]]
$bands[[2]]$name
[1] "B03"

$bands[[2]]$description
[1] "Green (band 3)"

$bands[[2]]$`eo:common_name`
[1] "green"

$bands[[2]]$`eo:center_wavelength`
[1] 0.56

$bands[[2]]$`eo:full_width_half_max`
[1] 0.045


$bands[[3]]
$bands[[3]]$name
[1] "B04"

$bands[[3]]$description
[1] "Red (band 4)"

$bands[[3]]$`eo:common_name`
[1] "red"

$bands[[3]]$`eo:center_wavelength`
[1] 0.665

$bands[[3]]$`eo:full_width_half_max`
[1] 0.038


$bands[[4]]
$bands[[4]]$name
[1] "B08"

$bands[[4]]$description
[1] "NIR 1 (band 8)"

$bands[[4]]$`eo:common_name`
[1] "nir"

$bands[[4]]$`eo:center_wavelength`
[1] 0.842

$bands[[4]]$`eo:full_width_half_max`
[1] 0.145



$roles
[1] "data"        "reflectance" "dataset"    

$title
[1] "Surface Reflectance - 10m"

$`xarray:open_dataset_kwargs`
$`xarray:open_dataset_kwargs`$chunks
named list()

$`xarray:open_dataset_kwargs`$engine
[1] "eopf-zarr"

$`xarray:open_dataset_kwargs`$op_mode
[1] "native"</code></pre>
</div>
</div>
<p>So, we will reformat it to be easier to work with. To do so, we first load the <code>tidyverse</code> package for data manipulation (installing it first, if necessary):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tidyverse")</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We will retain only the title and roles of each asset.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>asset_metadata <span class="ot">&lt;-</span> example_item[[<span class="st">"assets"</span>]] <span class="sc">|&gt;</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(\(asset) {</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    asset[<span class="fu">c</span>(<span class="st">"title"</span>, <span class="st">"roles"</span>)]</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(asset_metadata, <span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$SR_10m
$SR_10m$title
[1] "Surface Reflectance - 10m"

$SR_10m$roles
[1] "data"        "reflectance" "dataset"    


$SR_20m
$SR_20m$title
[1] "Surface Reflectance - 20m"

$SR_20m$roles
[1] "data"        "reflectance" "dataset"    


$SR_60m
$SR_60m$title
[1] "Surface Reflectance - 60m"

$SR_60m$roles
[1] "data"        "reflectance" "dataset"    


$AOT_10m
$AOT_10m$title
[1] "Aerosol optical thickness (AOT)"

$AOT_10m$roles
[1] "data"


$B01_20m
$B01_20m$title
[1] "Coastal aerosol (band 1) - 20m"

$B01_20m$roles
[1] "data"        "reflectance"</code></pre>
</div>
</div>
<p>Then, we can filter to only keep assets who have the <code>roles</code> ‚Äúdataset‚Äù (these are Zarr groups):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>asset_metadata <span class="sc">|&gt;</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">keep</span>(\(asset) {</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dataset"</span> <span class="sc">%in%</span> asset[[<span class="st">"roles"</span>]]</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  })</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$SR_10m
$SR_10m$title
[1] "Surface Reflectance - 10m"

$SR_10m$roles
[1] "data"        "reflectance" "dataset"    


$SR_20m
$SR_20m$title
[1] "Surface Reflectance - 20m"

$SR_20m$roles
[1] "data"        "reflectance" "dataset"    


$SR_60m
$SR_60m$title
[1] "Surface Reflectance - 60m"

$SR_60m$roles
[1] "data"        "reflectance" "dataset"    </code></pre>
</div>
</div>
<p>Or to those who have <code>roles</code> ‚Äúdata‚Äù, but <em>not</em> ‚Äúdataset‚Äù or ‚Äúmetadata‚Äù (these are individual Zarr arrays):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>zarr_arrays <span class="ot">&lt;-</span> asset_metadata <span class="sc">|&gt;</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">keep</span>(\(asset) {</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span> <span class="sc">%in%</span> asset[[<span class="st">"roles"</span>]] <span class="sc">&amp;</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span>(<span class="st">"dataset"</span> <span class="sc">%in%</span> asset[[<span class="st">"roles"</span>]] <span class="sc">|</span> <span class="st">"metadata"</span> <span class="sc">%in%</span> asset[[<span class="st">"roles"</span>]])</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(zarr_arrays)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "AOT_10m" "B01_20m" "B02_10m" "B03_10m" "B04_10m" "B05_20m" "B06_20m"
 [8] "B07_20m" "B08_10m" "B09_60m" "B11_20m" "B12_20m" "B8A_20m" "SCL_20m"
[15] "TCI_10m" "WVP_10m"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(zarr_arrays, <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$AOT_10m
$AOT_10m$title
[1] "Aerosol optical thickness (AOT)"

$AOT_10m$roles
[1] "data"


$B01_20m
$B01_20m$title
[1] "Coastal aerosol (band 1) - 20m"

$B01_20m$roles
[1] "data"        "reflectance"


$B02_10m
$B02_10m$title
[1] "Blue (band 2) - 10m"

$B02_10m$roles
[1] "data"        "reflectance"</code></pre>
</div>
</div>
</section>
<section id="now-it-is-your-turn" class="level2">
<h2 class="anchored" data-anchor-id="now-it-is-your-turn">üí™ Now it is your turn</h2>
<p>The following expercises will help you master the STAC API and understand how to find the data you need.</p>
<section id="task-1-explore-your-area-of-interest" class="level3">
<h3 class="anchored" data-anchor-id="task-1-explore-your-area-of-interest">Task 1: Explore Your Area of Interest</h3>
<ul>
<li>Go to <a href="http://bboxfinder.com/">http://bboxfinder.com/</a> and select an area of interest (AOI) (e.g.&nbsp;your hometown, a research site, etc.)</li>
<li>Copy the bounding box coordinates of your area of interest</li>
<li>Change the provided code above to search for data over your AOI</li>
</ul>
</section>
<section id="task-2-temporal-analysis" class="level3">
<h3 class="anchored" data-anchor-id="task-2-temporal-analysis">Task 2: Temporal Analysis</h3>
<ul>
<li>Compare data availability across different years for the <b>Sentinel-2 L-2A Collection</b>.</li>
<li>Search for items in the year 2022</li>
<li>Repeat the search for the year 2024</li>
</ul>
</section>
<section id="task-3-explore-the-sar-mission-and-combine-multiple-criteria" class="level3">
<h3 class="anchored" data-anchor-id="task-3-explore-the-sar-mission-and-combine-multiple-criteria">Task 3: Explore the SAR Mission and combine multiple criteria</h3>
<ul>
<li>Do the same for a different <code>Collection</code>, the <b>Sentinel-1 Level-1 GRD</b>, e.g.&nbsp;you can use the ID <code>sentinel-1-l1-grd</code></li>
<li>How many assets are available for the year 2024?</li>
</ul>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>This tutorial has provided a clear and practical introduction on how you can programmatically access and search through EOPF Sentinel Zarr Sample Service STAC API using R.</p>
</section>
<section id="whats-next" class="level2">
<h2 class="anchored" data-anchor-id="whats-next">What‚Äôs next?</h2>
<p>In the following <a href="../05_zarr_tools/52_eopf_stac_qgis.html">section</a>, we will provide a glimpse of the actual status on how to integrate the <strong>Sentinel Products</strong> of the <a href="https://stac.browser.user.eopf.eodc.eu/?.language=en">EOPF Sentinel Zarr Sample Service STAC Catalog</a> in <strong>Qgis</strong></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../04_eopf_and_stac/44_eopf_stac_xarray_tutorial.html" class="pagination-link" aria-label="From STAC to Data: Accessing EOPF Zarr with xarray">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">From STAC to Data: Accessing EOPF Zarr with xarray</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../05_zarr_tools/52_eopf_stac_qgis.html" class="pagination-link" aria-label="Access EOPF Zarr in QGIS Using STAC">
        <span class="nav-page-text"><span class="chapter-title">Access EOPF Zarr in QGIS Using STAC</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Development Seed, thriveGEO and SparkGeo</p>
</div>   
    <div class="nav-footer-center">
<p>License: Apache 2.0</p>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/eopf-toolkit/eopf-101" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>